<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√≥n Qu√† ƒê·∫∑c Bi·ªát!</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #fde7e7;
            /* ===== THAY ƒê·ªîI 1: Cho ph√©p cu·ªôn trang n·∫øu n·ªôi dung qu√° d√†i ===== */
            overflow-y: auto;
            overflow-x: hidden;
        }
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #fde7e7;
            z-index: 100;
            transition: opacity 0.7s ease-out, transform 0.7s ease-out;
        }
        #loader.hidden {
            opacity: 0;
            transform: scale(0.8);
            pointer-events: none;
        }
        #gift-box {
            width: 250px;
            height: 250px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        #gift-box:hover {
            transform: scale(1.1);
        }
        #loader p {
            font-size: 1.2em;
            color: #e91e63; 
            margin-top: 20px;
            font-family: 'Dancing Script', cursive; 
            font-size: 1.5em; 
        }
        
        /* ===== THAY ƒê·ªîI 2: M·ªü r·ªông th·∫ª v√† th√™m kho·∫£ng ƒë·ªám ===== */
        #birthday-card {
            display: none; 
            position: relative;
            max-width: 700px; /* TƒÉng chi·ªÅu r·ªông t·ªëi ƒëa */
            margin: 5vh auto 10vh auto; /* Th√™m l·ªÅ d∆∞·ªõi ƒë·ªÉ cu·ªôn tho·∫£i m√°i */
            padding: 40px;
            background: rgba(255, 255, 255, 0.9); 
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            opacity: 0;
            transform: scale(0.8);
            transition: opacity 0.7s 0.3s ease-in, transform 0.7s 0.3s ease-in;
            z-index: 50;
        }
        #birthday-card.visible {
            display: block;
            opacity: 1;
            transform: scale(1);
        }
        #birthday-card h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5em;
            color: #e91e63; 
            margin-bottom: 20px;
        }
        
        /* ===== THAY ƒê·ªîI 3: Cho ph√©p text t·ª± xu·ªëng d√≤ng ===== */
        .message-line {
            font-family: 'Dancing Script', cursive; 
            font-size: 1.8em; 
            color: #e91e63; 
            line-height: 1.8;
            /* height: 2.2em;  <-- X√≥a b·ªè chi·ªÅu cao c·ªë ƒë·ªãnh */
            display: block; 
            /* white-space: nowrap; <-- X√≥a b·ªè ƒë·ªÉ cho ph√©p ch·ªØ xu·ªëng d√≤ng */
            margin-bottom: 10px; /* Th√™m kho·∫£ng c√°ch gi·ªØa c√°c d√≤ng */
        }
        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background-color: #e91e63; 
            animation: blink 0.7s infinite;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        #cute-gif {
            width: 200px;
            margin-top: 20px;
            border-radius: 10px;
            opacity: 0; 
            transition: opacity 1s ease-in;
        }
        #cute-gif.visible {
            opacity: 1; 
        }
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; 
            z-index: 99;
        }
    </style>
</head>
<body>

    <div id="loader">
        <img id="gift-box" src="./gift.png" alt="H·ªôp qu√†">
        <p>Click v√†o m√≥n qu√† nh√©!</p>
    </div>
    
    <canvas id="confetti-canvas"></canvas>

    <div id="birthday-card">
        <h1>Ch√∫c M·ª´ng Sinh Nh·∫≠t! üéÇ</h1>
        
        <span class="message-line" id="line1"></span>
        <span class="message-line" id="line2"></span>
        <span class="message-line" id="line3"></span>
        <span class="message-line" id="line4"></span>
        <span class="message-line" id="line5"></span>
        <span class="message-line" id="line6"></span>
        <span class="message-line" id="line7"></span>
        <span class="message-line" id="line8"></span>
        <span class="message-line" id="line9"></span>
        <span class="message-line" id="line10"></span>
        <span class="message-line" id="line11"></span>
        <span class="message-line" id="line12"></span>
        <span class="message-line" id="line13"></span>
        
        <img id="cute-gif" src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExZTRsMnRua2tld3dueDNvZ3FzNnR1b2JneHQyOHVqamNqMmI5OHViZCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/2tNvsKkc0qM3m/giphy.gif" alt="Cute GIF">
    </div>

    <audio id="bg-music" src="./Hesitations.mp3" loop></audio>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loader = document.getElementById('loader');
            const giftBox = document.getElementById('gift-box');
            const birthdayCard = document.getElementById('birthday-card');
            const cuteGif = document.getElementById('cute-gif');
            const bgMusic = document.getElementById('bg-music');
            
            const myConfetti = confetti.create(document.getElementById('confetti-canvas'), {
                resize: true,
                useWorker: true
            });

            // C√°c l·ªùi ch√∫c c·ªßa b·∫°n (gi·ªØ nguy√™n)
            const messages = [
                { el: '#line1', text: "‚ù§Ô∏è G·ª≠i em, t√¨nh y√™u c·ªßa anh! ‚ù§Ô∏è" },
                { el: '#line2', text: "Y√™u em Ch√∫c em sinh nh·∫≠t vui v·∫ª,ng∆∞·ªùi con g√°i ta th∆∞∆°ng.‚ù§Ô∏è" },
                { el: '#line3', text: "~~~~N√†ng Th∆° v√† nh·ªØng ng√†y b√™n c·∫°nh n√†ng üë©~~~" },
                { el: '#line4', text: "Meoooo, khi b√™n c·∫°nh t√¥i, em c√≥ v·∫ª l√† sinh v·∫≠t v√¥ h·∫°i." },
                { el: '#line5', text: "Em gi·ªëng m·ªôt con m√®o quanh qu·∫©n b√™n c·∫£nh t√¥i c·∫£ ng√†yüòªüòªüòª" },
                { el: '#line6', text: "Con m√®o kh√¥ng th√®m ƒë·ªçng ƒë·∫øn ƒëi·ªán thoai, n√†ng ch·ªâ ng·ªìi ƒë√≥ m·ªü b√†i nh·∫°c m√† c·∫£ 2 nghe c√πng v√† l·∫Øc l∆∞ theo ƒëi·ªáu nh·∫°c ƒë√¥i khi c∆∞·ªùi kh√∫c kh√≠ch y√™n v·ªã khi th·∫•m nh·ªØng d√≤ng lyric" },
                { el: '#line7', text: "Con m√®o ng·ªìi l√™n ng∆∞·ªùi t√¥i vu·ªët t√≥c t√¥i r·ªìi h·ªèi bao gi·ªù anh l·∫°i v·ªÅ, nh·ªõ anh qu√° √†." },
                { el: '#line8', text: "Con m√®o b√≤ l√™n ng∆∞·ªùi t√¥i, y√™n v·ªã √©p tai n√†ng l√™n l·ªìng ng·ª±c tr√°i, ng∆∞·ªùi anh n√≥ng th√™, tim t√¥i l·∫°i ƒë·∫≠p nhanh n·ªØa r·ªìi." },
                { el: '#line9', text: "√îi t√¥i b·ªóng d∆∞ng tr·ªü th√†nh ch√∫ c√∫n nh·ªè, m·ªôt ch√∫ c√∫n ch·ªâ bi·∫øt h√≠t v√† li·∫øm tr√™n l·ªõp da c·ªßa n√†ng l√†m nh∆∞ l√† ch∆∞a bao h ƒë∆∞·ª£c li·∫øm v√† ng∆∞·ªùi.üêàüêà" },
                { el: '#line10', text: "üòäüòä h√≠t th·∫≠t s√¢u v√¨ ƒë√≥ l√† nh·ªØng kho·∫£nh kh·∫Øc qu√Ω gi√° nh·∫•t m√†." },
                { el: '#line11', text: "M√≥ng tay em c√†o c√†o v√†o da th·ªãt t√¥i, √¥i p√© n√≠ c·ªßa em nh·ªõ qu√° ü•∞ü•∞ü•∞" },
                { el: '#line12', text: "T√¥i nh√¨n em l·∫°i th·∫•y t√¨nh y√™u n√†y sao n√≥ y√™n b√¨nh l√†m sao th·ªùi gian c√≥ th·ªÉ d·ª´ng l·∫°i ƒë√¢y khi c·∫£ 2 ch·ªâ c·∫ßn nh∆∞ v·∫≠y c≈©ng c√≥ th·ªÉ qua nh·ªØng chu·ªïi ng√†y m√† v√¥ ∆∞u v√¥ lo. " },
                { el: '#line13', text: "Y√™u em r·∫•t nhi·ªÅu! üéâ" }
            ];

            loader.addEventListener('click', () => {
                loader.classList.add('hidden');
                bgMusic.play().catch(e => console.log("Kh√¥ng th·ªÉ t·ª± ƒë·ªông ph√°t nh·∫°c:", e));
                birthdayCard.classList.add('visible');
                startConfetti();
                startTyping();
            });

            function startConfetti() {
                const duration = 5 * 1000;
                const end = Date.now() + duration;

                function frame() {
                    myConfetti({
                        particleCount: 2,
                        angle: 60,
                        spread: 55,
                        origin: { x: 0 }
                    });
                    myConfetti({
                        particleCount: 2,
                        angle: 120,
                        spread: 55,
                        origin: { x: 1 }
                    });

                    if (Date.now() < end) {
                        requestAnimationFrame(frame);
                    }
                }
                frame(); 
            }

            async function startTyping() {
                const cursor = document.createElement('span');
                cursor.className = 'typing-cursor';
                cursor.textContent = '|';

                for (const msg of messages) {
                    const el = document.querySelector(msg.el);
                    // D·ª´ng l·∫°i n·∫øu kh√¥ng t√¨m th·∫•y th·∫ª HTML (l·ªói c≈©)
                    if (!el) {
                        console.error('Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠:', msg.el);
                        continue;
                    }

                    el.appendChild(cursor); 
                    await typeLine(el, msg.text, cursor);
                    el.removeChild(cursor);
                }
                
                cursor.remove(); 
                cuteGif.classList.add('visible'); 
            }
            
            function typeLine(element, text, cursor) {
                return new Promise(resolve => {
                    let index = 0;
                    const speed = 100; 
                    
                    const span = document.createElement('span'); 
                    element.insertBefore(span, cursor); 

                    function type() {
                        if (index < text.length) {
                            span.textContent += text.charAt(index);
                            index++;
                            setTimeout(type, speed);
                        } else {
                            resolve(); 
                        }
                    }
                    type();
                });
            }
        });
    </script>

</body>
</html>